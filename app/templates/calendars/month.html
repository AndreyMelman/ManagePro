{% extends 'base.html' %}
{% block body %}
<div class="container mt-4">
    <h2>Календарь — {{ month }}.{{ year }}</h2>
    {% set prev_month = month - 1 if month > 1 else 12 %}
    {% set prev_year = year if month > 1 else year - 1 %}
    {% set next_month = month + 1 if month < 12 else 1 %} {% set next_year=year if month < 12 else year + 1 %} <div
        class="mb-3">
        <a href="/calendar/{{ prev_year }}/{{ prev_month }}" class="btn btn-outline-secondary btn-sm">&lt;
            Предыдущий</a>
        <a href="/calendar/{{ next_year }}/{{ next_month }}" class="btn btn-outline-secondary btn-sm">Следующий &gt;</a>
</div>
{% if not month_view %}
<div class="alert alert-info">Нет данных для отображения календаря.</div>
{% else %}
<table class="table table-bordered text-center align-middle">
    <thead>
        <tr>
            <th>Пн</th>
            <th>Вт</th>
            <th>Ср</th>
            <th>Чт</th>
            <th>Пт</th>
            <th>Сб</th>
            <th>Вс</th>
        </tr>
    </thead>
    <tbody>
        {% set days = month_view.days %}
        {% for week in range(0, days|length, 7) %}
        <tr>
            {% for day in days[week:week + 7] %}
            <td style="min-width:120px;">
                <a href="/calendar/day/{{ day.date }}" class="fw-bold text-decoration-none">{{ day.date.day }}</a>
                <ul class="list-unstyled small mt-2">
                    {% for event in day.events %}
                    <li>
                        {% if event.event_type == 'task' %}
                        <span class="badge bg-primary">Задача</span>
                        {% else %}
                        <span class="badge bg-success">Встреча</span>
                        {% endif %}
                        {{ event.title }}
                    </li>
                    {% endfor %}
                </ul>
            </td>
            {% endfor %}
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endif %}
</div>
{% endblock %}